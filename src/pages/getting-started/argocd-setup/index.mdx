---
title: ArgoCD Setup
description: Complete the setup of the ArgoCD tool so it can use Artifactory as a Helm repository
---

<PageDescription>

Complete the steps for setting up ArgoCD so it can use the Helm repository in Artifactory 

</PageDescription>

## Overview

ArgoCD is a complete [**GitOps**](https://www.weave.works/technologies/gitops/) tool for managing the deployment of application images into deployment environments. 
These deployment environments often include ones for development lifecycle stages such as *test*, *pre-prod*, and *production*. 

The Developer Tools environment packages apps into two types of artifacts, Docker images and Helm charts. 
The environment uses Jenkins to build the artifacts and ArgoCD to deploy them. 
The artifacts are stored in two registries/repositories:
- Docker images are stored in the [IBM Cloud Container Registry](https://cloud.ibm.com/docs/services/Registry)
- Helm charts are stored in the [Artifactory repository](/getting-started/artifactory-setup)

ArgoCD is part of the Developer Tools environment's complete CI/CD solution:

<AnchorLinks small>
  <AnchorLink to="/guides/continuous-integration">Continuous Integration</AnchorLink>
  <AnchorLink to="/guides/continuous-deployment">Continuous Deployment</AnchorLink>
</AnchorLinks>

## Prerequisites

Before setting up ArgoCD, set up the [Helm chart repository in Artifactory](/getting-started/artifactory-setup) so that ArgoCD can use it.

##  Configuration

Configure ArgoCD to use Artifactory.

### Clone the ArgoCD repository

The ArgoCD repository contains files and samples for configuring ArgoCD.

- Clone the repository to your development machine

  ```bash
  git clone https://github.com/ibm-garage-cloud/template-argocd-test
  cd template-argocd-test
  ```

### Get the Helm repository location

The Helm repository is in Artifactory. ArgoCD will need the URL to that repository.

- In the Artifactory console, select the Home page

- In the Set Me Up section, click on the `generic-local` repository

  ![Set Me Up - Repositories](setupartifactory.png "Set Me Up: Repositories")

- In the Set Me Up dialog for the generic-local repository, copy the Deploy URL

  ![Set Me Up - Generic Local Repository](artifactoryurlsetup.png "Set Me Up: generic-local Repository")

### Update the ArgoCD configuration file

The repo you cloned contains an ArgoCD configuration file. Put the Helm repository location in that file
and deploy it to your Developer Tools environment.

- In your local copy of the `template-argocd-test` repo, open the `config/argocd-helm-repo.yaml` file in an editor

- Edit the `data.helm.url` property to replace the value `<artifactory helm repository location>` 
with the URL of the Helm repository location in Artifactory

  ```yaml
  apiVersion: v1
  kind: ConfigMap
  metadata:
    name: argocd-cm
    namespace: tools
  data:
    helm.repositories: |
      - url: <artifactory helm repository location>
        name: helm-repository-location
  ```

Use the kubectl CLI to deploy the edited configuration file.

- Test to confirm that your shell is logged into your cluster

  ```bash 
  kubectl version --short
  ```

- Apply the configuration file to the cluster in the `tools` namespace

  ```bash 
  kubectl apply -f argocd-helm-repo.yaml -n tools
  ```

  You can also apply the file using the `config/addconfigmap.sh` script in the `template-argocd-test` repo.

Verify that the new configuration has deployed

- In the Kubernetes dashboard or OpenShift console, navigate to the Config Maps in the `tools` namespace

- Select the `argocd-cm` config map and confirm that its `helm.repositories` property specifies the
Artifactory URL

## Conclusion

ArgoCD now has the configuration file in the Developer Tools environment that it needs to access the Helm chart repository in Artifactory.
